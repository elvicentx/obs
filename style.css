// Reemplaza esto con tu JWT Token de StreamElements
const token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJjaXRhZGVsIiwiZXhwIjoxNzY4MDcxNzAzLCJqdGkiOiIzOGZhOWJhNC0xMTNiLTQyN2MtOGRmMS0xYzllMzdlNTU1ZGYiLCJjaGFubmVsIjoiNWYxZTUwMGE2MjM1Mjk0ZDYzZTNmNzg4Iiwicm9sZSI6Im93bmVyIiwiYXV0aFRva2VuIjoicUtZQlhKRHhBMEVVVENBaXhYNW5sSWhDQ1ItRHdZUGtwbXZHejdRTWVDOEw0LXJ4IiwidXNlciI6IjVmMWU1MDBhNjIzNTI5NjJkOGUzZjc4NyIsInVzZXJfaWQiOiI3NzNjNmM3ZS03NjU5LTQ2YjctYmQzZS04MWYyNmNiYjBjZTQiLCJ1c2VyX3JvbGUiOiJjcmVhdG9yIiwicHJvdmlkZXIiOiJ0d2l0Y2giLCJwcm92aWRlcl9pZCI6IjE1MDI4MTQ3MSIsImNoYW5uZWxfaWQiOiJlNWViN2ZjNC02YTcwLTQ0NDItYmY1Yy1jMjAxYWZjZWRkODgiLCJjcmVhdG9yX2lkIjoiMWM3YWM3NTUtNGM2Ni00ZDQxLTg0NWUtODQwZDAzYjk0ZTcwIn0.lXksy4SiPXvCNY19_kUlLTwoGNk_cGpC9M9qFNESTG8";

// Duración de la animación en milisegundos (12 segundos)
const duracionAnimacionMs = 12000;

function ejecutarAlerta(nombre) {
    const slotDisponible = document.querySelector('.alerta-personaje.hidden');
    if (!slotDisponible) return;

    const textoElement = slotDisponible.querySelector('.texto-nombre');
    textoElement.innerText = nombre;

    slotDisponible.classList.remove('hidden');
    slotDisponible.classList.add('active');

    setTimeout(() => {
        slotDisponible.classList.remove('active');
        slotDisponible.classList.add('hidden');
        textoElement.innerText = ''; 
    }, duracionAnimacionMs);
}

// Conexión con StreamElements (no modificar)
const socket = io("https://realtime.streamelements.com", { transports: ["websocket"] });

socket.on("connect", () => {
    console.log("Conectado a StreamElements");
    socket.emit("authenticate", { method: "jwt", token: token });
});

socket.on("event", (event) => {
    if (event.type === 'follower') {
        const username = event.data.username;
        ejecutarAlerta(username);
    }
});

socket.on("event:test", (event) => {
    if (event.listener === 'follower-latest') {
        const username = event.event.name;
        ejecutarAlerta(username);
    }
});
